# Merlin Auction Bot

Telegram бот для автоматического парсинга автомобилей с аукциона Merlin и отправки информации в Telegram чат с ценами из DoneDeal.

## Требования

- Python 3.11 или выше
- Telegram Bot Token
- Telegram Chat ID

## Установка

1. Клонируйте репозиторий или перейдите в директорию проекта:
```bash
cd merlin_auction
```

2. Создайте виртуальное окружение (рекомендуется):
```bash
python -m venv venv
```

3. Активируйте виртуальное окружение:

**Windows:**
```bash
venv\Scripts\activate
```

**Linux/Mac:**
```bash
source venv/bin/activate
```

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Настройка

1. Откройте файл `bot.py` и настройте следующие параметры:

```python
API_TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"  # Токен вашего Telegram бота
auction_chat_id = YOUR_CHAT_ID        # ID чата для отправки сообщений
```

2. Получите Telegram Bot Token:
   - Найдите [@BotFather](https://t.me/BotFather) в Telegram
   - Отправьте команду `/newbot` и следуйте инструкциям
   - Скопируйте полученный токен

3. Получите Chat ID:
   - Найдите [@userinfobot](https://t.me/userinfobot) в Telegram
   - Отправьте команду `/start`
   - Скопируйте ваш Chat ID

## Запуск

Запустите бота:

```bash
python bot.py
```

После запуска бот будет ожидать команду `/run` в Telegram. Отправьте эту команду боту, чтобы начать парсинг аукциона.

## Использование

1. Запустите бота (см. раздел "Запуск")
2. В Telegram отправьте боту команду `/run`
3. Бот начнет парсинг аукциона и будет отправлять информацию о машинах в указанный чат

## Функциональность

- **Асинхронный парсинг**: Быстрый сбор данных со всех страниц аукциона
- **Детальная информация**: Автоматическое получение дополнительных данных со страниц машин
- **Цены из DoneDeal**: Автоматический поиск средней цены на DoneDeal с fallback-логикой
- **Мгновенная отправка**: Информация о каждой машине отправляется в Telegram сразу после получения цены

## Структура проекта

```
merlin_auction/
├── bot.py              # Основной файл бота
├── merlin.py           # Логика парсинга и обработки данных
├── requirements.txt    # Зависимости проекта
└── README.md          # Документация
```

## Зависимости

- `pyTelegramBotAPI` - для работы с Telegram Bot API
- `beautifulsoup4` - для парсинга HTML
- `requests` - для синхронных HTTP запросов
- `aiohttp` - для асинхронных HTTP запросов

## Примечания

- Бот использует случайные User-Agent для имитации мобильных устройств
- Между запросами добавлены задержки для избежания блокировок
- При отсутствии цены на DoneDeal используются fallback-стратегии поиска

## Поддержка

При возникновении проблем проверьте:
- Правильность токена бота и Chat ID
- Наличие интернет-соединения
- Версию Python (должна быть 3.11 или выше)
- Установлены ли все зависимости из requirements.txt
